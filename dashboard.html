<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="dashboard.css">
  <link rel="stylesheet" href="styles.css">
  
  <title>Dashboard</title>
</head>

<header>
  <div class="icon1">
    <img src="img/icon1.png" alt="">
  </div>
  <nav>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="dashboard.html">Dashboard</a></li>
    </ul>
  </nav>
</header> 
<header style="display: none;"><button class="toggleNav" style="display: none;"></button></header>


<body>
	<section id="grid-wrapper">
      <div class="grid">

        <div class="col-3-4">
          <div class="module no-pad">
            <!-- map -->
              <div id="map">
                <svg id="svgmap" viewBox="0 0 2000 1000"   preserveAspectRatio="xMidYMid"></svg>
              </div>
              <div class="search">
               <input type="text" name="addr" value="" id="addr" placeholder="Type an ip address here.." />
                <button type="button" id="submitButton"></button>
             </div>
          </div>
        </div>

         <!-- <div class="col-1-4">
          <div class="module">
            <aside id="comment-sect"></aside>
          </div>
        </div> -->

      </div>
     
      <div class="grid">
         <div class="col-1-1">
          <div class="module">
            <div class="chart-container">
              <canvas id="chart3"></canvas>
            </div>
          </div>
        </div>


      </div>
  
      <div class="grid">
        <div class="col-3-4">
          <div class="module">
            <table id="myTable" cellpadding="4" class="dataTable no-footer" role="grid" aria-describedby="myTable_info">
              <thead>
                <tr role="row">
                  <td class="sorting_asc" tabindex="0" aria-controls="myTable" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Type of Collision : activate to sort column descending" style="width: 593px;">
                    <h3>Type of Collision</h3>
                  </td>

                  <td class="sorting" tabindex="0" aria-controls="myTable" rowspan="1" colspan="1" aria-label="Crashes : activate to sort column ascending" style="width: 234px;">
                    <h3>Crashes</h3>
                  </td>

                  <td class="sorting" tabindex="0" aria-controls="myTable" rowspan="1" colspan="1" aria-label="Injuries : activate to sort column ascending" style="width: 215px;">
                    <h3>Injuries</h3>
                  </td>

                  <td class="sorting" tabindex="0" aria-controls="myTable" rowspan="1" colspan="1" aria-label="Severe Injuries : activate to sort column ascending" style="width: 370px;">
                    <h3>Severe Injuries</h3>
                  </td>

                  <td class="sorting" tabindex="0" aria-controls="myTable" rowspan="1" colspan="1" aria-label=" Deaths : activate to sort column ascending" style="width: 208px;">
                    <h3>Deaths</h3>
                  </td>
                </tr>
              </thead>

              <tbody>
                <tr role="row" class="odd">
                  <td class="sorting_1">Broadside</td>
                  <td>1385</td>
                  <td>1109</td>
                  <td>21</td>
                  <td>5</td>
                </tr>

                <tr role="row" class="even">
                  <td class="sorting_1">Head-On</td>
                  <td>379</td>
                  <td>213</td>
                  <td>7</td>
                  <td>1</td>
                </tr>

                <tr role="row" class="odd">
                  <td class="sorting_1">Hit Object</td>
                  <td>503</td>
                  <td>178</td>
                  <td>13</td>
                  <td>1</td>
                </tr>

                <tr role="row" class="even">
                  <td class="sorting_1">Not In Reference</td>
                  <td>1</td>
                  <td>2</td>
                  <td>0</td>
                  <td>0</td>
                </tr>

                <tr role="row" class="odd">
                  <td class="sorting_1">Not Stated</td>
                  <td>7</td>
                  <td>2</td>
                  <td>0</td>
                  <td>0</td>
                </tr>

                <tr role="row" class="even">
                  <td class="sorting_1">Other</td>
                  <td>329</td>
                  <td>171</td>
                  <td>21</td>
                  <td>1</td>
                </tr>

                <tr role="row" class="odd">
                  <td class="sorting_1">Overturned</td>
                  <td>83</td>
                  <td>67</td>
                  <td>7</td>
                  <td>0</td>
                </tr>

                <tr role="row" class="even">
                  <td class="sorting_1">Rear End</td>
                  <td>2835</td>
                  <td>1283</td>
                  <td>19</td>
                  <td>1</td>
                </tr>

                <tr role="row" class="odd">
                  <td class="sorting_1">Sideswipe</td>
                  <td>2439</td>
                  <td>542</td>
                  <td>11</td>
                  <td>0</td>
                </tr>

                <tr role="row" class="even">
                  <td class="sorting_1">Veh./Pedestrian</td>
                  <td>466</td>
                  <td>470</td>
                  <td>34</td>
                  <td>4</td>
                </tr>
              </tbody>
            </table>

          </div>
        </div>
        
         <div class="col-1-4">
          <div class="module no-bg">
            <div class="tile">
              <div class="chart-container">
                <canvas id="chart2"></canvas>
            </div>
            </div>
            <div class="tile">
               <div class="chart-container">
                <canvas id="chart"></canvas>
              </div>
            </div>
          </div>
        </div>
  
      </div>
      
      <div class="grid">
        <div class="col-1-4">
          <div class="module">
           
          </div>
        </div>
        <div class="col-1-4">
          <div class="module">
            
          </div>
        </div>
        <div class="col-1-4">
          <div class="module">
            
          </div>
        </div>
        <div class="col-1-4">
          <div class="module">
            
          </div>
        </div>
      </div>
   
  </section>
</main>

<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.17.0/TweenMax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.17.0/utils/Draggable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"></script>
<script>

function cssvar(name) { return getComputedStyle(document.documentElement).getPropertyValue(name);}


var toggleBtn = document.querySelector("button.toggleNav"),
  main = document.querySelector("main"),
  nav = document.querySelector("nav");
  toggleBtn.addEventListener("click", CollapseNav, false);

function CollapseNav() {
  main.classList.toggle("offset");
  nav.classList.toggle("opacity");
}

var tiles  = $(".tile");
var margin = 5;
var height = tiles.height();
var threshold = "25%";

Draggable.create(".tile", {
  onDragEnd: checkCollisions
});

layoutTiles(true);

function checkCollisions() {
  var i = tiles.length;
  while (i--) {
    if (this.hitTest(tiles[i], threshold)) {
      changePosition($(this.target), $(tiles[i]));
    }     
  }
  
  layoutTiles(); 
}

function changePosition(target1, target2) {
  if (target1.data("index") > target2.data("index")) {
    target1.insertBefore(target2);
  } else {
    target1.insertAfter(target2);
  }
}


function layoutTiles(initial) {
  $(".tile").each(function(i, node) {
    
    var time = 0.2;
    var y = i * margin + (i);
    
    if (initial) {
      time = 0;
    }
        
    $(node).data("index", i);
    TweenLite.to(node, time, { x: 0, y: y });
  });
}

const chunk = (arr, size) => Array.apply(null, { length: Math.ceil(arr.length / size) }).map((v, i) => arr.slice(i * size, i * size + size));
var results = [...document.querySelectorAll("tbody td")].map((x) => x.innerText);
var field = "injuries";
var data = chunk(results, 5).map((d, i) => ({
    "type": d[0],
    "crashes": d[1],
    "injuries": d[2],
    "severe injuries": d[3],
    "deaths": d[4]
  })).sort((a, b) => a[field] - b[field]);
//console.log(data);

var bardata = {
  labels: data.map(x=>x["type"]),
  datasets: [{
    label: "injuries",
    backgroundColor: cssvar('--cta-light'),
    borderColor: cssvar('--cta'),
    borderWidth: 2,
    hoverBackgroundColor: cssvar('--cta'),
    data: data.map(x=>x["injuries"]),
  }]
};

var options = {
  responsive: true,
  maintainAspectRatio: false,
};

new Chart('chart3', {
  type: 'bar',
  options: options,
  data: bardata
});


var ctx = document.getElementById("chart2").getContext('2d');

var lineExample1 = [cssvar('--primary'), cssvar('--secondary'), cssvar('--tertiary'),cssvar('--quaternary'), cssvar('--cta')];
var lineExample2 = [cssvar('--primary'), cssvar('--secondary'), cssvar('--tertiary'),cssvar('--quaternary'), cssvar('--cta')];

var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: data.map(x=>x["type"]),
        datasets: [
        {
            label: 'Injuries', 
            data: data.map(x=>x["injuries"]), 
            backgroundColor: cssvar('--quaternary'),
            borderColor: cssvar('--quaternary'),
            
            borderWidth: 1, 
            type: 'line', 
            fill: false        
        },
                  {
            label: 'crashes', 
            data: data.map(x=>x["crashes"]), 
            backgroundColor: cssvar('--secondary'),
            borderColor:  cssvar('--secondary'),
            
            borderWidth: 1, 
            type: 'line',
            fill: false        
        }]
    },
    options: {
      responsive: true, 
      maintainAspectRatio: false, 

    }

});


var ctx = document.getElementById("chart").getContext('2d');
var myChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
        labels: data.map(x=>x["type"]),
        datasets: [{    
            data: data.map(x=>x["injuries"]), 
          
            borderColor: [ cssvar('--tertiary'), cssvar('--bckg'), cssvar('--cta'), cssvar('--secondary'),  cssvar('--quaternary'), cssvar('--quinary'), cssvar('--senary'), cssvar('--septenary'), cssvar('--octonary'), cssvar('--nonary')], // Add custom color border 
            backgroundColor:  [ cssvar('--tertiary'), cssvar('--bckg'), cssvar('--cta'), cssvar('--secondary'), cssvar('--quaternary'), cssvar('--quinary'), cssvar('--senary'), cssvar('--septenary'), cssvar('--octonary'), cssvar('--nonary')], // Add custom color background (Points and Fill)
            borderWidth: 1 
        }]},         
    options: {
      responsive: true, 
      maintainAspectRatio: false, 

    }
});

  var margin = 0,
    width = document.getElementById('map').getBoundingClientRect().width - margin,
    height =document.getElementById('map').getBoundingClientRect().height - margin;

  var SVG = d3
    .select("svg")
    .attr("width", width + margin)
    .attr("height", height + margin)
    .attr("class", "map")
    .call(d3.behavior.zoom().on("zoom", zoomed))
    .append("g")


  var projection = d3.geo
    .mercator()
    .scale(2000) 
    .rotate([90, 0]) 
    .center([-10, 45]) 
    .translate([width / 2, height / 2]); 

var div = d3.select("body")
        .append("div")   
        .attr("class", "tooltip")               
        .style("opacity", 0);

var zoom = d3.behavior.zoom().scaleExtent([1, 8]).on("zoom", zoomed);
function zoomed() { SVG.attr("transform", "translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")"); }
function zoomToCircle(circle) {
    var cx = parseFloat(circle.attr("cx"));
    var cy = parseFloat(circle.attr("cy"));

    var scale = 2; 
    var duration = 1000; 

    var translateX = width / 2 - cx * scale;
    var translateY = height / 2 - cy * scale;

    SVG.transition()
        .duration(duration)
        .attr("transform", "translate(" + translateX + "," + translateY + ")scale(" + scale + ")")
        .each("end", function () {
            SVG.call(d3.behavior.zoom().scale(scale).translate([translateX, translateY]).on("zoom", function () {
                SVG.attr("transform", "translate(" + d3.event.translate + ") scale(" + d3.event.scale + ")");
            }));
        });
}

const textInput = document.getElementById('addr');
const submitButton = document.getElementById('submitButton');

textInput.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
        submitButton.click();
        textInput.value ="";
    }
});

function ipConverter(input) {
    return typeof input === 'number' ?
        ( (input>>>24) +'.' + (input>>16 & 255) +'.' + (input>>8 & 255) +'.' + (input & 255) ) :
        typeof input === 'string' ?
            input.split('.').reduce(function(ipInt, octet) { return (ipInt<<8) + parseInt(octet, 10)}, 0) >>> 0 :
            (() => { throw new Error("Input must be either a string representing an IP address or an integer."); })();
}

async function getLocationByIpOrInt(ipAddress) {
    try {
    
        const decimalIp = typeof ipAddress == "string" ? ipAddress : ipConverter(ipAddress);
        
        const response = await fetch(`https://ipinfo.io/${decimalIp}/json`);
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('Error fetching location:', error);
        return null;
    }
}


document.getElementById('submitButton').addEventListener('click', function() {

    const inputValue = document.getElementById('addr').value;

    getLocationByIpOrInt(ipConverter(inputValue)).then(locationData => {
            console.log(locationData);

            var res = locationData.loc.split(",").map(x=>parseInt(x));
            var lat = res[0];
            var lon = res[1];
      
            SVG.append("circle")
               .attr("class", (d) => locationData.country )
               .attr("r", (d) => 20)
               .attr("fill", (d) => "rgba(255,255,255,1)")
               .attr("fill-opacity", 1)
               .attr("stroke", "rgba(255,255,255,.25)")
               .attr("stroke-width", 20)
               .attr("cx", (d) => projection([lon,lat])[0])
               .attr("cy", (d) => projection([lon,lat])[1])
               .attr("data-lat", (d)=> lat )
               .attr("data-lng", (d)=> lon )
               .attr("data-city", (d)=> locationData.city )
               .attr("data-region", (d)=> locationData.region )
               .attr("data-country", (d)=> locationData.country )
               .attr("data-postal", (d)=> locationData.postal )
               .attr("data-ip", (d)=> locationData.ip )
               .call(function(x){return zoomToCircle(x);})

              SVG.selectAll("circle")
                .on("mouseover", function(d) {      
                  div.transition()        
                     .duration(200)      
                     .style("opacity", 1);      
                  div.html(
                    `
                    <h3>City</h3> 
                    ${ d3.select(this).attr('data-city') }
                  <hr>
              <h3>Region</h3> 
                    ${ d3.select(this).attr('data-region') }
                  <hr>
              <h3>Country</h3> 
                    ${ d3.select(this).attr('data-country') }
                  <hr>
              <h3>Zip/Postal</h3> 
                    ${ d3.select(this).attr('data-postal') }
                    <hr>
              <h3>IP</h3> 
                    ${ d3.select(this).attr('data-ip') }
                    `)
                   .style("left", (d3.event.pageX + 15) + "px")     
                   .style("top", (d3.event.pageY - 30) + "px");    
              })   
                  
              .on("mouseout", function(d) {       
                  div.transition()        
                     .duration(500)      
                     .style("opacity", 0);   
                });

              var navTl = new TimelineMax();
              navTl.fromTo(SVG.selectAll(`circle.${locationData.country}`), 0.75,
                {
                  attr:{r:20}
                },
                {
                  attr:{r:10},
                  ease: Power2.easeOut,
                  repeat: -1, 
                  yoyo: true,
             
                }
              );

              document.getElementById('addr').value = "";


        });
});


d3.json("https://raw.githubusercontent.com/jdamiani27/Data-Visualization-and-D3/master/lesson4/world_countries.json",Draw);
setTimeout(() => { Plot(); },"500");


function Draw(geo_data) {
  "use strict";
  //console.log(geo_data);
  var path = d3.geo.path().projection(projection);
  SVG.selectAll("path")
    .data(geo_data.features)
    .enter()
    .append("path")
    .attr("d", path)
    .style("fill", "#3b404c")
    .style("stroke", "#24282c")
    .style("stroke-width", 5);
}

/* function Plot(){
    var datum = [{"city":"Freeport","state":"IL","lat":42.2891,"lng":-89.6346,"zip":61032,"country":"US","population":23884},{"city":"Johnston","state":"IA","lat":41.691,"lng":-93.7234,"zip":50131,"country":"US","population":23856},{"city":"Rosemont","state":"CA","lat":38.5478,"lng":-121.3553,"zip":"95827 95826","country":"US","population":23845},{"city":"Webster Groves","state":"MO","lat":38.5866,"lng":-90.3544,"zip":63119,"country":"US","population":23838},{"city":"Willoughby","state":"OH","lat":41.6459,"lng":-81.4084,"zip":"44094 44096","country":"US","population":23823},{"city":"Farragut","state":"TN","lat":35.8731,"lng":-84.1821,"zip":37934,"country":"US","population":23795},{"city":"Highland","state":"IN","lat":41.5483,"lng":-87.4588,"zip":46322,"country":"US","population":23794},{"city":"Fountain Hills","state":"AZ","lat":33.6073,"lng":-111.7398,"zip":"85268 85269","country":"US","population":23739},{"city":"Waverly","state":"MI","lat":42.7401,"lng":-84.6354,"zip":"48917 48908","country":"US","population":23723},{"city":"Champlin","state":"MN","lat":45.1702,"lng":-93.3903,"zip":55316,"country":"US","population":23666},{"city":"Lexington","state":"SC","lat":33.989,"lng":-81.2202,"zip":"29072 29071","country":"US","population":23665},{"city":"Roseburg","state":"OR","lat":43.2231,"lng":-123.352,"zip":"97470 97471","country":"US","population":23657},{"city":"Kenmore","state":"WA","lat":47.7516,"lng":-122.2489,"zip":98028,"country":"US","population":23611},{"city":"Fresno","state":"TX","lat":29.5357,"lng":-95.4696,"zip":77545,"country":"US","population":23608},{"city":"Jacksonville Beach","state":"FL","lat":30.2782,"lng":-81.4045,"zip":"32250 32240","country":"US","population":23583},{"city":"Middletown","state":"DE","lat":39.445,"lng":-75.7183,"zip":19709,"country":"US","population":23573},{"city":"Brookings","state":"SD","lat":44.3022,"lng":-96.7859,"zip":"57007 57006","country":"US","population":23530},{"city":"Gardner","state":"KS","lat":38.8122,"lng":-94.9275,"zip":66030,"country":"US","population":23488},{"city":"Griffin","state":"GA","lat":33.2418,"lng":-84.2748,"zip":"30224 30223","country":"US","population":23485},{"city":"Copiague","state":"NY","lat":40.6707,"lng":-73.3922,"zip":"11726 11757 11701","country":"US","population":23442},{"city":"Vega Baja","state":"PR","lat":18.4406,"lng":-66.3997,"zip":"00693","country":"US","population":23418},{"city":"Van Buren","state":"AR","lat":35.4483,"lng":-94.3528,"zip":"72956 72957","country":"US","population":23398},{"city":"Clinton","state":"UT","lat":41.1395,"lng":-112.0656,"zip":84015,"country":"US","population":23389},{"city":"West Springfield","state":"VA","lat":38.7771,"lng":-77.2268,"zip":22152,"country":"US","population":23372},{"city":"Rock Springs","state":"WY","lat":41.5947,"lng":-109.2209,"zip":"82901 82902","country":"US","population":23361},{"city":"Pottstown","state":"PA","lat":40.2508,"lng":-75.6445,"zip":19464,"country":"US","population":23356},{"city":"North Platte","state":"NE","lat":41.1263,"lng":-100.7641,"zip":"69101 69103","country":"US","population":23309},{"city":"Camp Springs","state":"MD","lat":38.8052,"lng":-76.9199,"zip":"20744 20746 20748","country":"US","population":23269},{"city":"Fernley","state":"NV","lat":39.5627,"lng":-119.1906,"zip":"89408 89406 89429","country":"US","population":23035},{"city":"Glassboro","state":"NJ","lat":39.7014,"lng":-75.1113,"zip":"08028","country":"US","population":23014},{"city":"Radcliff","state":"KY","lat":37.8204,"lng":-85.9365,"zip":"40160 42701 40159","country":"US","population":22981},{"city":"Watertown","state":"WI","lat":43.1893,"lng":-88.7285,"zip":"53098 53094","country":"US","population":22978},{"city":"Keene","state":"NH","lat":42.9494,"lng":-72.2998,"zip":"03431 03435","country":"US","population":22907},{"city":"Duncan","state":"OK","lat":34.5408,"lng":-97.9215,"zip":"73533 73055 73534","country":"US","population":22759},{"city":"Kapolei","state":"HI","lat":21.3399,"lng":-158.0677,"zip":96707,"country":"US","population":22701},{"city":"Fairhope","state":"AL","lat":30.5209,"lng":-87.8813,"zip":"36532 36559","country":"US","population":22605},{"city":"Biddeford","state":"ME","lat":43.4673,"lng":-70.4511,"zip":"04005 04006 04007","country":"US","population":22438},{"city":"Central Falls","state":"RI","lat":41.8901,"lng":-71.3934,"zip":"02863","country":"US","population":22359},{"city":"Ruston","state":"LA","lat":32.5328,"lng":-92.6363,"zip":"71272 71270","country":"US","population":22282},{"city":"Evans","state":"CO","lat":40.366,"lng":-104.739,"zip":"80645 80634 80620","country":"US","population":22092},{"city":"Pascagoula","state":"MS","lat":30.3666,"lng":-88.5506,"zip":"39581 39567 39595 39568 39569","country":"US","population":21904},{"city":"Shelby","state":"NC","lat":35.2904,"lng":-81.5451,"zip":"28150 28152 28151","country":"US","population":21712},{"city":"Gallup","state":"NM","lat":35.5182,"lng":-108.7431,"zip":87301,"country":"US","population":21672},{"city":"Gardner","state":"MA","lat":42.5845,"lng":-71.9868,"zip":"01440 01441","country":"US","population":21090},{"city":"South Burlington","state":"VT","lat":44.4622,"lng":-73.2202,"zip":"05403 05408 05407","country":"US","population":20241},{"city":"Badger","state":"AK","lat":64.8006,"lng":-147.3877,"zip":"99705 99711","country":"US","population":19182},{"city":"Weirton","state":"WV","lat":40.406,"lng":-80.5671,"zip":26062,"country":"US","population":18971},{"city":"Ansonia","state":"CT","lat":41.3443,"lng":-73.0689,"zip":"06401","country":"US","population":18954},{"city":"Ammon","state":"ID","lat":43.4745,"lng":-111.9568,"zip":"83401 83406 83403","country":"US","population":17921},{"city":"Jamestown","state":"ND","lat":46.9063,"lng":-98.6937,"zip":"58401 58402 58405","country":"US","population":15850},{"city":"Belgrade","state":"MT","lat":45.7789,"lng":-111.1736,"zip":59714,"country":"US","population":10941}]

      // .data() takes an array of objects
      SVG.selectAll("circle")
        .data(datum)
        .enter()
        .append("circle")
        .attr("r", (d) => 20)
        .attr("fill", (d) => "rgba(58,177,200,1)")
        .attr("fill-opacity", 1)
        .attr("stroke", "rgba(58,177,200,.25)")
        .attr("stroke-width", 20)
        .attr("cx", (d) => projection([d['lng'],d['lat']])[0])
        .attr("cy", (d) => projection([d['lng'],d['lat']])[1])
        .attr("data-city", (d)=> d['city'] )
        .attr("data-region", (d)=>d['state'] )
        .attr("data-country", (d)=> d['country'] )
        .attr("data-postal", (d)=> d['zip'] )
        .attr("data-ip", (d)=> "No Ip data" )


        d3.select("svg").selectAll("circle")
          .on("mouseover", function(d) {      
            div.transition()        
               .duration(200)      
               .style("opacity", 1);      
            div.html(
              `
              <h3>City</h3> 
              ${ d3.select(this).attr('data-city') }
            <hr>
        <h3>Region</h3> 
              ${ d3.select(this).attr('data-region') }
            <hr>
        <h3>Country</h3> 
              ${ d3.select(this).attr('data-country') }
            <hr>
        <h3>Zip/Postal</h3> 
              ${ d3.select(this).attr('data-postal') }
              <hr>
              <h3>IP</h3> 
                    ${ d3.select(this).attr('data-ip') }
              `)
             .style("left", (d3.event.pageX + 15) + "px")     
             .style("top", (d3.event.pageY - 30) + "px");    
        })   
        // fade out tooltip on mouse out               
        .on("mouseout", function(d) {       
            div.transition()        
               .duration(500)      
               .style("opacity", 0);   
        });//end hover


      //animate circles
      var navTl = new TimelineMax();
      navTl.fromTo(SVG.selectAll("circle"), 0.75,
        {
          attr:{r:20}
        },
        {
          attr:{r:10},
          ease: Power2.easeOut,
          repeat: -1, 
          yoyo: true,
          //onUpdate: applyAngle
        }
      );//end fromTO

}*/
</script>

<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://fb.me/react-15.3.0.min.js"></script>
<script src="https://fb.me/react-dom-15.3.0.min.js"></script>
<script type="text/babel"> 

  var h = {
		    getTime: function() {
		      var month = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
		      var d = new Date();
		      var mon = month[d.getMonth()];
		      var day = d.getDate();
		      var year = d.getFullYear();
		      var dateAll = mon + " " + day + ", " + year;
		      return dateAll;
		    }
		  }
		var AddCommentForm = React.createClass({
		  processComment: function(e) {
		    e.preventDefault();
		    var commentData = {
		        commentName: this.refs.name.value,
		        commentBody: this.refs.desc.value
		      }
		      
		    this.props.addMyComment(commentData);
		   
		    this.refs.commentForm.reset();

		  },
		  render: function() {
		    return (
		      <section>
		        <form ref="commentForm" onSubmit={this.processComment}>
		          <textarea ref="desc" placeholder="Write something"/>
		          <input type="text" ref="name" placeholder="Your Name" value="user1"/>
		          <button>Add Comment</button>
		        </form>
		      </section>
		    )
		  }
		});

		var NewComment = React.createClass({
		  render: function() {
		    return (
		      <section className="comment">
		        <ul>
		          <li>

		            <div className="flex">
		              <img src="https://via.placeholder.com/50x50" />
		              <div className="bubble">
		              	<p>{this.props.details.commentBody}</p>
		        		    <p className="author"><span>{this.props.details.commentName}</span><span>&nbsp;&nbsp;&nbsp; {h.getTime()}</span></p>
		              </div>
		             </div>
		            
		          </li>
		        </ul>
		      </section>
		    )
		  }
		});

		var App = React.createClass({
		  getInitialState: function() {
		    return {
		      comments: {}
		    }
		  },
		  		  addComment: function(commentData) {

		    var TS = (new Date()).getTime();
		  
		    this.state.comments['comment-id' + TS] = commentData;
		    this.setState({
		      comments: this.state.comments
		    });
		  },
		  renderComment: function(key) {
		    return (
		      <li>
		         <NewComment key={key} index={key} details={this.state.comments[key]}/>
		       </li>
		    )
		  },
		  render: function() {
		    return (
		      <div>
		        {
		          Object
		            .keys(this.state.comments)
		            .map(this.renderComment)
		        }
		        {
		          
		        }
		        <AddCommentForm addMyComment={this.addComment}/>
		        <div className="pre"><pre>{JSON.stringify(this.state, null, 2)}</pre></div>
		      </div>
		    )
		  }
		});

		ReactDOM.render(<App />, document.getElementById('comment-sect'));
</script>
</body>

<footer class="acerca-de">   
  <div class="footercont">
    <div class="socialCompl">
      <h3>Calidad del aire</h3>
      <div class="social">
        <a href="#" target="_blank" class="link"><img src="https://assets.codepen.io/9051928/codepen_1.png" alt="" /></a>
        <a href="#" target="_blank" class="link"><img src="https://assets.codepen.io/9051928/x.png" alt="" /></a>
        <a href="#" target="_blank" class="link"><img src="https://assets.codepen.io/9051928/youtube_1.png" alt="" /></a>
      </div>
      <p style="color: #818181; font-size: smaller">2024 © All Rights Reserved</p>
    </div>
      <div class="integrantes">
        <h4>Acerca de nosotros</h4>
        <ul>
          <li>
            <a href="https://github.com/EdadVega/" target="_blank">Edwin Velasquez</a>
          </li>
          <li>
            <a href="https://github.com/danielBuGo/" target="_blank">Daniel Builes</a>
          </li>
          <li>
            <a href="https://github.com/garcescamilo/" target="_blank">Camilo Garces</a>
          </li>
        </ul>
      </div>

      <div class="integrantes">
        <h4>Terminos y contacto</h4>
        <ul>
          <li><a href="politica_privacidad.html">Política de Privacidad</a> <br> <a href="terminos_condiciones.html">Términos y Condiciones</a></li>
          <li>Contacto: <a href="mailto:info@nombreempresa.com">info@calidaddelaire.com</a></li></ul>
      </div>
    </div>
</footer>
</html>